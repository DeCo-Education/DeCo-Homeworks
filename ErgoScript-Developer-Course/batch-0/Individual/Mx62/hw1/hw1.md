# Virtual Blockchain on Ergo
## Goal:
Mint a PoW minable token or NFT with its own virtual blockchain
## Parties involved:
Minter and miners
# Transactions
## Mint
A minter decides on a token name, supply, tokenomics, etc.  
Global box 0 is used as the input for minting the tokens, and many boxes of tokens are the output, each referencing the previous' spendability height, forming a virtual blockchain.  
Each box will contain an RSA private key (n in R4 and d in R5), generated by the minter, with its prime factors witheld from the blockchain and discarded immediately.  
Every x private keys would be generated with primes that are both 1 bit longer than the previous x box's primes, creating exponential difficulty eras with steps similar to halvings.  
The previous box's spendability height will be stored in R6 to form the virtual blockchain.  
Each box's guard script will:
* Prevent the box from being spent before a spendability height, starting at the current block height and incrementing with each block
* Prevent the box from being spent before the previous box of the token has been spent
* Prevent the box from being spent unless it produces 2 outputs:
  * The first output is the miner's reward
  * The second output is a record of the transaction that can't be spent
* Allow the box to be spent when the output box's R4 contains the miner's address, encrypted by the proper RSA public key, and R5 contains the previous record box ID
## Mine
A miner will try to guess the RSA public key (e) for the current box, and send a transaction with their address encrypted in R4, and the record box ID in R5, in order to spend the box.  
Miners' transactions can't be frontran in the mempool, because the public key can't be derived from the message, and the reward is sent to the encrypted address.  
The miner's boxes will be:
* A reward box, including:
  * Simple wallet address guard script
  * Tokens from the mined box
* A record box, including:
  * Guard script (1 == 0)
  * The name of the token in R4
  * The spendability height of the mined box in R5
  * The miner's address in R6
  * Extra data defined by the virtual blockchain  

This creates the actual mined "blocks" of the virtual blockchain.
## Conclusion
This virtual PoW blockchain may work well on a small scale, but suffers from a lack of dynamic difficulty adjustment. It's difficult to prevent miners from working on later boxes within the same difficulty era, because the parameters for the puzzle are already known, and the difficulty of later blocks is the same as the current block.  
The only option is to make every box more difficult, but this means either:
* adding a bit to the primes every block, doubling their maximum values, which would make mining impossible quickly
* or adding a constant or linear value to the primes' maximum values, which I don't know the security implications of
